{"version":3,"sources":["/Users/rquast/projects/fspec.videos/src/__tests__/recording-option-validation.test.ts"],"sourcesContent":["/**\n * Feature: spec/features/recording-option-validation.feature\n *\n * Tests for recording option validation\n */\n\nimport { describe, it, expect } from 'vitest';\nimport { validateRecordingOptions } from '../validator.js';\n\ndescribe('Feature: Recording option validation', () => {\n  describe('Scenario: Reject negative terminal width', () => {\n    it('should reject negative width with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'test-script.ts',\n        outputPath: 'test.webm',\n        height: 30,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with width set to -1\n      options.width = -1;\n\n      // @step Then the command should fail with error \"Width must be greater than 0\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        'Width must be greater than 0'\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Reject zero terminal height', () => {\n    it('should reject zero height with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'test-script.ts',\n        outputPath: 'test.webm',\n        width: 120,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with height set to 0\n      options.height = 0;\n\n      // @step Then the command should fail with error \"Height must be greater than 0\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        'Height must be greater than 0'\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Reject FPS above maximum', () => {\n    it('should reject FPS above 120 with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'test-script.ts',\n        outputPath: 'test.webm',\n        width: 120,\n        height: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with fps set to 200\n      options.fps = 200;\n\n      // @step Then the command should fail with error \"FPS must be between 1 and 120\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        'FPS must be between 1 and 120'\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Reject non-existent script file', () => {\n    it('should reject non-existent script with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'non-existent-script.ts',\n        outputPath: 'test.webm',\n        width: 120,\n        height: 30,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with a non-existent script path\n      // (options.scriptPath is already non-existent)\n\n      // @step Then the command should fail with error containing \"Script file not found\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        /Script file not found/\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Accept valid recording options', () => {\n    it('should accept valid options and allow recording to start', async () => {\n      // @step Given I want to record a demo video\n      // @step And I have a valid demo script file\n      const options = {\n        scriptPath: 'src/demos/basic-usage.ts',\n        outputPath: 'test.webm',\n        width: 120,\n        height: 30,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with width 120, height 30, and fps 30\n      // (options already set with valid values)\n\n      // @step Then the validation should pass\n      await expect(validateRecordingOptions(options as any)).resolves.toBeUndefined();\n\n      // @step And the recording should start\n      // (validation passing allows recording to proceed)\n    });\n  });\n\n  describe('Scenario: Reject terminal width above maximum', () => {\n    it('should reject width above 300 with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'test-script.ts',\n        outputPath: 'test.webm',\n        height: 30,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with width set to 400\n      options.width = 400;\n\n      // @step Then the command should fail with error \"Width must be between 1 and 300\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        'Width must be between 1 and 300'\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Reject terminal height above maximum', () => {\n    it('should reject height above 100 with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'test-script.ts',\n        outputPath: 'test.webm',\n        width: 120,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with height set to 150\n      options.height = 150;\n\n      // @step Then the command should fail with error \"Height must be between 1 and 100\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        'Height must be between 1 and 100'\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n\n  describe('Scenario: Reject invalid output directory', () => {\n    it('should reject unwritable output directory with clear error message', async () => {\n      // @step Given I want to record a demo video\n      const options = {\n        scriptPath: 'src/demos/basic-usage.ts', // Use existing script file\n        outputPath: '/invalid/readonly/path.webm',\n        width: 120,\n        height: 30,\n        fps: 30,\n        headless: true,\n      };\n\n      // @step When I run the record command with an unwritable output path\n      // (options.outputPath is already set to unwritable path)\n\n      // @step Then the command should fail with error containing \"Output directory is not writable\"\n      await expect(validateRecordingOptions(options as any)).rejects.toThrow(\n        /Output directory is not writable/\n      );\n\n      // @step And no recording should be started\n      // (validation prevents recording from starting)\n    });\n  });\n});\n"],"names":["describe","it","expect","validateRecordingOptions","options","scriptPath","outputPath","height","fps","headless","width","rejects","toThrow","resolves","toBeUndefined"],"mappings":"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","file":"recording-option-validation.test.js"}